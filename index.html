<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Jaxb2-rich-contract-plugin : Implements some JAXB plugins to generate advanced contract scenarios from XSD">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Jaxb2-rich-contract-plugin</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/mklemm/jaxb2-rich-contract-plugin">View on GitHub</a>

          <h1 id="project_title">Jaxb2-rich-contract-plugin</h1>
          <h2 id="project_tagline">Implements some JAXB plugins to generate advanced contract scenarios from XSD</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/mklemm/jaxb2-rich-contract-plugin/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/mklemm/jaxb2-rich-contract-plugin/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="jaxb2-rich-contract-plugin" class="anchor" href="#jaxb2-rich-contract-plugin" aria-hidden="true"><span class="octicon octicon-link"></span></a>jaxb2-rich-contract-plugin</h1>

<p>Current Version: 1.5.1</p>

<p>This module is a collection of several plugins for the JAXB2 (Java API for XML binding) "XSD to Java Compiler" (XJC).
These plugins are intended to add support for additional contracts to the classes generated by XJC.
Currently, there are 5 plugin classes:</p>

<ol>
<li>
<strong><a href="#group-interface">group-interface</a></strong>: When using <code>&lt;attribute-group&gt;</code> or <code>&lt;group&gt;</code> elements in an XSD, they are transformed as interface
definitions, and any complexTypes using the groups will be generated as classes implementing this interface.</li>
<li>
<strong><a href="#constrained-properties">constrained-properties</a></strong>: Will generate a complexTypes element members as bound and/or constrained properties as per
the JavaBeans spec.</li>
<li>
<strong><a href="#clone">clone</a></strong>: Will generate a simple deep "clone" method for the generated classes based on the heuristic that it only
makes sense to traverse further down in the cloned object tree for members of types that are actually cloenable themselves.</li>
<li>
<strong><a href="#copy">copy</a></strong>: Similar to "clone", will generate a simple deep "createCopy" method. The java API contract for the <code>java.lang.Cloneable</code>
interface and the rules for overriding <code>Object.clone()</code> are defective by design. So the "copy" plugin uses its own
API to realize the desired behavior.
Also can generate a "partial createCopy" method, that takes a <code>PropertyTree</code> object which represents an include/exclude
rule for nodes in the object tree to clone. Excluded nodes will not be cloned and left alone.
Optionally, corresponding copy constructors can also be generated.</li>
<li>
<strong><a href="#immutable">immutable</a></strong>: Will make generated classes immutable. Only makes sense together with "fluent-builder" plugin (see below),
or any other builder or initialisation facility, like the well-known "value-constructor" plugin.</li>
<li>
<strong><a href="#fluent-builder">fluent-builder</a></strong>: Generates a builder class for every class generated. Builders are implemented as inner classes,
static methods are provided for a fluent builder pattern in the form <code>MyClass.builder().withPropertyA(...).withPropertyB(...).build()</code>.
Builders also contain "copy..." methods to initialize the builder from another instance. Partial copying is also supported in the same way as in <strong>clone</strong>.
This is particularly useful together with <code>-Ximmutable</code> (see above), but not usable together with <code>-Xconstrained-properties</code> (see below).</li>
<li>
<strong><a href="#meta">meta</a></strong>: Generates a nested class representing a static metamodel of the generated classes. In the "enhanced" version, this contains
information about the type and the XSD element from which the property was generated, in "simple" mode, there are only constants for the property names.</li>
</ol>

<h3>
<a id="usage" class="anchor" href="#usage" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<h4>
<a id="general" class="anchor" href="#general" aria-hidden="true"><span class="octicon octicon-link"></span></a>General</h4>

<p>jaxb2-rich-contract-plugin is a plugin to the XJC "XML to Java compiler" shipped with the
reference implementation of JAXB, included in all JDKs since 1.6.
It is targeted on version 2.2 of the JAXB API.
In order to make it work, you need to:</p>

<ul>
<li><p>Add the jar file to the classpath of XJC</p></li>
<li><p>Add the JAXB 2.2 XJC API to the classpath of XJC, if your environment is running by default under JAXB 2.1 or lower.</p></li>
<li><p>Add the corresponding activating command-line option to XJC's invocation,
see below for details of each of the plugins</p></li>
<li><p>Each of the plugins, except "-Ximmutable", has one or more sub-options to fine-control its behavior.
These sub-option must be given after the corresponding main "-X..." activation option, to avoid naming conflicts.
Names of sub-options can be given dash-separated or in camelCase.</p></li>
<li><p>The "immutable" and "constrained-properties" plugins are mutually exclusive. An object cannot be both immutable
and send change notifications.</p></li>
</ul>

<h4>
<a id="from-maven" class="anchor" href="#from-maven" aria-hidden="true"><span class="octicon octicon-link"></span></a>From Maven</h4>

<p>There is a maven repository for this project under:</p>

<p><a href="http://maven.klemm-scs.com/release">http://maven.klemm-scs.com/release</a></p>

<p>Add this repository to your pom.xml:</p>

<pre><code>&lt;pluginRepositories&gt;
    &lt;pluginRepository&gt;
        &lt;releases&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;updatePolicy&gt;always&lt;/updatePolicy&gt;
            &lt;checksumPolicy&gt;warn&lt;/checksumPolicy&gt;
        &lt;/releases&gt;
        &lt;id&gt;jaxb2-plugins&lt;/id&gt;
        &lt;name&gt;JAXB2 XJC Plugin Repository&lt;/name&gt;
        &lt;url&gt;http://maven.klemm-scs.com/release&lt;/url&gt;
        &lt;layout&gt;default&lt;/layout&gt;
    &lt;/pluginRepository&gt;
&lt;/pluginRepositories&gt;
</code></pre>

<p>You should add "maven-jaxb2-plugin" to your <code>&lt;build&gt;</code>
configuration.
Then add "jaxb2-rich-contract-plugin" as an XJC plugin ("plugin for plugin") to the maven plugin declaration.
The following example shows all possible options reflecting their default values:</p>

<div class="highlight highlight-xml"><pre>    &lt;<span class="pl-ent">build</span>&gt;
        &lt;<span class="pl-ent">plugins</span>&gt;
            &lt;<span class="pl-ent">plugin</span>&gt;
                &lt;<span class="pl-ent">groupId</span>&gt;org.jvnet.jaxb2.maven2&lt;/<span class="pl-ent">groupId</span>&gt;
                &lt;<span class="pl-ent">artifactId</span>&gt;maven-jaxb2-plugin&lt;/<span class="pl-ent">artifactId</span>&gt;
                &lt;<span class="pl-ent">version</span>&gt;0.11.0&lt;/<span class="pl-ent">version</span>&gt;
                &lt;<span class="pl-ent">executions</span>&gt;
                    &lt;<span class="pl-ent">execution</span>&gt;
                        &lt;<span class="pl-ent">id</span>&gt;xsd-generate-2.1&lt;/<span class="pl-ent">id</span>&gt;
                        &lt;<span class="pl-ent">phase</span>&gt;generate-sources&lt;/<span class="pl-ent">phase</span>&gt;
                        &lt;<span class="pl-ent">goals</span>&gt;
                            &lt;<span class="pl-ent">goal</span>&gt;generate&lt;/<span class="pl-ent">goal</span>&gt;
                        &lt;/<span class="pl-ent">goals</span>&gt;
                    &lt;/<span class="pl-ent">execution</span>&gt;
                &lt;/<span class="pl-ent">executions</span>&gt;
                &lt;<span class="pl-ent">configuration</span>&gt;
                    &lt;<span class="pl-ent">schemaIncludes</span>&gt;
                        &lt;<span class="pl-ent">schemaInclude</span>&gt;**/*.xsd&lt;/<span class="pl-ent">schemaInclude</span>&gt;
                    &lt;/<span class="pl-ent">schemaIncludes</span>&gt;
                    &lt;<span class="pl-ent">strict</span>&gt;true&lt;/<span class="pl-ent">strict</span>&gt;
                    &lt;<span class="pl-ent">verbose</span>&gt;true&lt;/<span class="pl-ent">verbose</span>&gt;
                    &lt;<span class="pl-ent">extension</span>&gt;true&lt;/<span class="pl-ent">extension</span>&gt;
                    &lt;<span class="pl-ent">removeOldOutput</span>&gt;true&lt;/<span class="pl-ent">removeOldOutput</span>&gt;
                    &lt;<span class="pl-ent">args</span>&gt;
                        &lt;<span class="pl-ent">arg</span>&gt;-Xclone&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-cloneThrows=n&lt;/<span class="pl-ent">arg</span>&gt;
                        &lt;<span class="pl-ent">arg</span>&gt;-Xconstrained-properties&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-constrained=y&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-bound=y&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-setterThrows=n&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-generateTools=y&lt;/<span class="pl-ent">arg</span>&gt;
                        &lt;<span class="pl-ent">arg</span>&gt;-Xfluent-builder&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-generateTools=y&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-narrow=n&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-copyPartial=y&lt;/<span class="pl-ent">arg</span>&gt;
                        &lt;<span class="pl-ent">arg</span>&gt;-Xcopy&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-partial=y&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-generateTools=y&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-constructor=y&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-narrow=n&lt;/<span class="pl-ent">arg</span>&gt;
                        &lt;<span class="pl-ent">arg</span>&gt;-Xgroup-contract&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-declareSetters=y&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-declareBuilderInterface=y&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-upstreamEpisodeFile=/META-INF/jaxb-interfaces.episode&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-downstreamEpisodeFile=/META-INF/jaxb-interfaces.episode&lt;/<span class="pl-ent">arg</span>&gt;
                        &lt;<span class="pl-ent">arg</span>&gt;-Xmeta&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-generateTools=y&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-extended=n&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-camelCase=n&lt;/<span class="pl-ent">arg</span>&gt;
                            &lt;<span class="pl-ent">arg</span>&gt;-metaClassName=PropInfo&lt;/<span class="pl-ent">arg</span>&gt;
                        &lt;<span class="pl-ent">arg</span>&gt;-Ximmutable&lt;/<span class="pl-ent">arg</span>&gt;
                        &lt;<span class="pl-ent">arg</span>&gt;...&lt;/<span class="pl-ent">arg</span>&gt;
                    &lt;/<span class="pl-ent">args</span>&gt;
                    &lt;<span class="pl-ent">plugins</span>&gt;
                        &lt;<span class="pl-ent">plugin</span>&gt;
                            &lt;<span class="pl-ent">groupId</span>&gt;com.kscs.util&lt;/<span class="pl-ent">groupId</span>&gt;
                            &lt;<span class="pl-ent">artifactId</span>&gt;jaxb2-rich-contract-plugin&lt;/<span class="pl-ent">artifactId</span>&gt;
                            &lt;<span class="pl-ent">version</span>&gt;1.5.1&lt;/<span class="pl-ent">version</span>&gt;
                        &lt;/<span class="pl-ent">plugin</span>&gt;
                    &lt;/<span class="pl-ent">plugins</span>&gt;
                    &lt;<span class="pl-ent">dependencies</span>&gt;
                        <span class="pl-c">&lt;!-- Put this in if your default JAXB version is 2.1 or lower,</span>
<span class="pl-c">                        or if &amp;quot;tools.jar&amp;quot; isn't in your classpath --&gt;</span>
                        &lt;<span class="pl-ent">dependency</span>&gt;
                            &lt;<span class="pl-ent">groupId</span>&gt;org.glassfish.jaxb&lt;/<span class="pl-ent">groupId</span>&gt;
                            &lt;<span class="pl-ent">artifactId</span>&gt;jaxb-runtime&lt;/<span class="pl-ent">artifactId</span>&gt;
                            &lt;<span class="pl-ent">version</span>&gt;2.2.11&lt;/<span class="pl-ent">version</span>&gt;
                        &lt;/<span class="pl-ent">dependency</span>&gt;
                        &lt;<span class="pl-ent">dependency</span>&gt;
                            &lt;<span class="pl-ent">groupId</span>&gt;org.glassfish.jaxb&lt;/<span class="pl-ent">groupId</span>&gt;
                            &lt;<span class="pl-ent">artifactId</span>&gt;jaxb-core&lt;/<span class="pl-ent">artifactId</span>&gt;
                            &lt;<span class="pl-ent">version</span>&gt;2.2.11&lt;/<span class="pl-ent">version</span>&gt;
                        &lt;/<span class="pl-ent">dependency</span>&gt;
                        &lt;<span class="pl-ent">dependency</span>&gt;
                            &lt;<span class="pl-ent">groupId</span>&gt;org.glassfish.jaxb&lt;/<span class="pl-ent">groupId</span>&gt;
                            &lt;<span class="pl-ent">artifactId</span>&gt;jaxb-xjc&lt;/<span class="pl-ent">artifactId</span>&gt;
                            &lt;<span class="pl-ent">version</span>&gt;2.2.11&lt;/<span class="pl-ent">version</span>&gt;
                        &lt;/<span class="pl-ent">dependency</span>&gt;
                    &lt;/<span class="pl-ent">dependencies</span>&gt;
                &lt;/<span class="pl-ent">configuration</span>&gt;
            &lt;/<span class="pl-ent">plugin</span>&gt;
        &lt;/<span class="pl-ent">plugins</span>&gt;
    &lt;/<span class="pl-ent">build</span>&gt;</pre></div>

<p>Note: the <code>&lt;extension&gt;</code> flag must be set to "true" in order to make XJC accept any extensions at all.</p>

<p>Note: jaxb2-rich-contract-plugin implements JAXB and XJC APIs version 2.2.7. You most likely will have
    to add the dependencies to these libraries to your classpath effective at XJC runtime. See the
    <code>dependencies</code> element above on how to do this.</p>

<h3>
<a id="version-history" class="anchor" href="#version-history" aria-hidden="true"><span class="octicon octicon-link"></span></a>Version History</h3>

<ul>
<li>
<strong>1.0.0</strong>:    Initial Version</li>
<li>
<strong>1.0.1</strong>:    Added constrained-property plugin</li>
<li>
<strong>1.0.2</strong>:    Added partial clone method generation</li>
<li>
<strong>1.0.3</strong>:    Improvements in partial clone</li>
<li>
<strong>1.0.4</strong>:    Added fluent builder and immutable plugins</li>
<li>
<strong>1.0.5</strong>:    Added chainable fluent builder support</li>
<li>
<strong>1.1.0</strong>:    New: <code>-Ximmutable</code>, Copy constructor support,
            fluent-builder copy from instance support,
            general fixes.
            Removed option to generate fluent builders without
            chained builder support.</li>
<li>
<strong>1.1.1</strong>:    New: Type-safe selector support for partial clone/copy logic.</li>
<li>
<strong>1.1.2</strong>:    Big fixes in selector logic</li>
<li>
<strong>1.1.3</strong>:    Minor bug fixes in fluent-builder</li>
<li>
<strong>1.1.4</strong>:    Fixed an error in fluent-builder where an initialization method wasn't properly overridden in derived builder classes, leading to the wrong builder type being returned when using chained sub-builders.</li>
<li>
<strong>1.1.5</strong>:    Fixed error in Release Build process</li>
<li>
<strong>1.1.6</strong>:    Fixed bug in group-contract plugin: Property names customised via binding info were generated incorrectly in the interface definitions.</li>
<li>
<strong>1.2.0</strong>:    Major changes to the logic of partial cloning. The partial clone <code>PropertyTree</code> pattern replaces the previous <code>PropertyPath</code>, which had pretty
            unclear semantics. The new <code>PropertyTree</code> builders now just create a property tree, and on invocation of the "clone()" or "copyOf()" methods or the
            copy constructor, it is decided by an additional parameter whether the property tree should be considered an exclusion or an inclusion pattern.
            Additionally, the group-interface plugin has been modified to create interfaces also for the fluent builders, if the fluent-builder plugin is activated.</li>
<li>
<strong>1.2.3</strong>:    Added "Copyable" interface and "createCopy" method which does the same thing as the "clone()" method, but doesn't suffer from the defective-by-design java.lang.Cloneable contract. It is planned to als add a "copyFrom" method to copy the state of another object into an existing object.</li>
<li>
<strong>1.3.1</strong>:    Made fluent-builder plugin work in an "episode" (modular generation and compilation) context by also integrating compiled classes on the XJC classpath in the search for base and property classes.</li>
<li>
<strong>1.3.6</strong>:    Also made group-interface work in an "episode" context, and fixed bug where empty interfaces were created if no implementation class for them could be found in the current module.</li>
<li>
<strong>1.4.0</strong>:    group-interface is using its own episode file to maintain relationships to definitions in upstream modules.
            Command-line options for a specific plugin must now be given immediately after the plugin activation option ("-X..."). This way, name conflicts between plugin options are avoided.
            Static source files are generated via the JCodeModel.addResourceFile API, so a bug where the source files ended up in the root of the project tree should be fixed now.
            group-interface and fluent-builder now are working together more reliably.</li>
<li>
<strong>1.5.0</strong>:    Added new Plugin "-Xmeta" to generate an inner class containing static meta information about the properties of a class.
            Internally, a common base class for plugins was extracted to help in command-line parsing and command-line documentation.</li>
<li>
<strong>1.5.1</strong>:    Major updates to documentation, improvements to <code>-Xmeta</code> to expose static information about XSD definitions of properties.</li>
</ul>

<h2>
<a id="group-interface" class="anchor" href="#group-interface" aria-hidden="true"><span class="octicon octicon-link"></span></a>group-interface</h2>

<h3>
<a id="motivation" class="anchor" href="#motivation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation</h3>

<p>Out of the box, the only polymorphism supported by classes generated from an XSD is the <code>&lt;extension&gt;</code> notion,
transformed directly into an inheritance relationship by XJC.
However, pure inheritance relationships are often inflexible and do not always reflect the intention
of generating a "contract" that implementing classes must follow.</p>

<p>With this plugin, it is possible for your application code to treat classes using one or more specific model or attribute groups in a common way. Objects can be initialised or used via the interface.</p>

<h3>
<a id="function" class="anchor" href="#function" aria-hidden="true"><span class="octicon octicon-link"></span></a>Function</h3>

<p>For definition of contracts, two additional XSD constructs, the <code>&lt;group&gt;</code> and <code>&lt;attributeGroup&gt;</code>,
are readily available in XSD, but they're currently ignored by standard XJC and simply treated as an inclusion of
elements or attributes into a generated class definition.
The group-interface plugin changes that and generates an <code>interface</code> definition for each <code>group</code> or <code>attributeGroup</code>
found in your model, defines the attributes or elements declared in the groups as get and set methods on the interface,
and makes each generated class using the group or attributeGroup implement this interface.
New in version 1.2: The group-interface plugin will generate interfaces for the generated fluent builder classes,
if the fluent-builder plugin is also activated.</p>

<h3>
<a id="usage-1" class="anchor" href="#usage-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>See below on how to add the jaxb2-rich-contract-plugin to your plugin path when building your project with maven.
group-interface is activated by adding the <code>-Xgroup-contract</code> command-line option to your XJC invocation.
For group-interface, there are currently no further command line options.</p>

<h3>
<a id="bugs" class="anchor" href="#bugs" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bugs</h3>

<ul>
<li>Currently none known.</li>
</ul>

<h2>
<a id="constrained-properties" class="anchor" href="#constrained-properties" aria-hidden="true"><span class="octicon octicon-link"></span></a>constrained-properties</h2>

<h3>
<a id="motivation-1" class="anchor" href="#motivation-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation</h3>

<p>Many GUI applications use data binding to connect the data model to the view components. The JavaBeans standard
defines a simple component model that also supports properties which send notifications whenever the are about to be changed,
and there are even vetoable changes that allow a change listener to inhibit modification of a property.
While the JAvaBeans standard is a bit dated, data binding and property change notification can come in handy in many situations,
even for debugging or reverse-engineering existing code, because you can track any change made to the model instance.</p>

<h3>
<a id="function-1" class="anchor" href="#function-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Function</h3>

<p>constrained-properties generates additional code in the property setter methods of the POJOs generated by XJC that
allow <code>PropertyChangeListener</code>s and <code>VetoableChangeListener</code>s to be attached to any instance of a XJC-generated class.</p>

<p>Currently, <strong>indexed properties</strong> are NOT supported in the way specified by JavaBeans, but instead, if a property represents a collection,
a collection proxy class is generated that supports its own set of collection-specific change notifications, vetoable and other.
This decision has been made because by default XJC generates collection properties rather than indexed properties,
and indexed properties as mandated by JavaBeans are generally considered "out of style".</p>

<h3>
<a id="usage-2" class="anchor" href="#usage-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>Activate the plugin by giving command-line option <code>-Xconstrained-properties</code> to XJC.</p>

<p>Other options supported:</p>

<h4>
<a id="-setter-throwsyn" class="anchor" href="#-setter-throwsyn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-setter-throws=</code>y/n</h4>

<p>Generate the setter method with "throws PropertyVetoException" if constrained properties are
used. If no, only a RuntimeException is thrown on a PropertyVeto event. Default: n</p>

<h4>
<a id="-constrainedyn" class="anchor" href="#-constrainedyn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-constrained=</code>y/n</h4>

<p>Generate constrained properties, where a listener can inhibit the property change. Default: y</p>

<h4>
<a id="-boundyn" class="anchor" href="#-boundyn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-bound=</code>y/n</h4>

<p>Generate bound properties. Default: y</p>

<h4>
<a id="-generate-toolsyn" class="anchor" href="#-generate-toolsyn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-generate-tools=</code>y/n</h4>

<p>To support Collection-specific change events and behavior, additional classes are required.
If you set this option to "yes", these auxiliary classes will be generated into the source
code along with the generated JAXB classes. If you set this to "no", you will have to include
the plugin artifact into the runtime classpath of your application.</p>

<h3>
<a id="limitations" class="anchor" href="#limitations" aria-hidden="true"><span class="octicon octicon-link"></span></a>Limitations</h3>

<ul>
<li><p>The JavaBeans standard is only loosely implemented in the generated classes.</p></li>
<li><p>Indexed Properties as defined in JavaBeans are not supported.</p></li>
<li><p>The CollectionChange behavior implemented by the classes is not yet documented
and non-standard.</p></li>
</ul>

<h3>
<a id="bugs-1" class="anchor" href="#bugs-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Bugs</h3>

<ul>
<li>Currently none known.</li>
</ul>

<h2>
<a id="copy" class="anchor" href="#copy" aria-hidden="true"><span class="octicon octicon-link"></span></a>copy</h2>

<h3>
<a id="motivation-2" class="anchor" href="#motivation-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation</h3>

<p>Sometimes it is necessary to create a deep copy of an object. There are various approaches to this. The "copy" plugin
defines its own interface, contract, and definitions that are somewhat different from the standard java "java.lang.Cloneable"
contract. The entry point generated in the source code is called <code>createCopy</code>, there are optionally also copy constructors.</p>

<h3>
<a id="function-2" class="anchor" href="#function-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Function</h3>

<p>The <code>copy</code> plugin generates a deep clone method for each of the generated classes, based on the following assumptions:</p>

<ul>
<li><p>Instances of any other classes implementing the <code>com.kscs.util.jaxb.Copyable</code> interface are copyable by the same
semantics as "this".</p></li>
<li><p>Objects implementing <code>java.lang.Cloneable</code> and not throwing "CloneNotSupportedException" are also reliably cloneable
by their "clone" Method.</p></li>
<li><p>Objects not implementing <code>java.lang.Cloneable</code> or primitive types are assumed to be immutable,
their references are copied over, they are not cloned.</p></li>
<li><p>Optionally, generates a "partial createCopy" method that takes a <code>PropertyTree</code> instance which represents a
specification of the nodes in the object tree to copy. The PropertyTree is built up by an intuitive builder
pattern:</p></li>
</ul>

<p><code>final PropertyTree excludeEmployees = PropertyTree.builder().with("company").with("employees").build();</code></p>

<ul>
<li>There is also a type-safe way to build a PropertyPath instance by using a generated classes' <code>Selector</code> sub structure. The following will generate the same selection as above:</li>
</ul>

<p><code>final PropertyTree excludeEmployees = Business.Select.root().company().employees().build()</code></p>

<p>Then, you would partially clone an object tree like this:</p>

<div class="highlight highlight-java"><pre>    <span class="pl-s">final</span> <span class="pl-stj">BusinessPartner</span> businessPartnerCopy <span class="pl-k">=</span> businessPartner<span class="pl-k">.</span>createCopy(excludeEmployees, <span class="pl-stj">PropertyTreeUse</span><span class="pl-c1"><span class="pl-k">.</span>EXCLUDE</span>);</pre></div>

<p>Which is the same as</p>

<div class="highlight highlight-java"><pre>    <span class="pl-s">final</span> <span class="pl-stj">BusinessPartner</span> businessPartnerCopy <span class="pl-k">=</span> businessPartner<span class="pl-k">.</span>copyExcept(excludeEmployees);</pre></div>

<p>This way, the copy of the original <code>businessPartner</code> will have no employees attached to the contained <code>company</code>.
It is also possible to copy only a specific subset of the original object tree, excluding everything else. The
inverse result of the above would be generated by:</p>

<div class="highlight highlight-java"><pre>    <span class="pl-s">final</span> <span class="pl-stj">BusinessPartner</span> businessPartnerCopy <span class="pl-k">=</span> businessPartner<span class="pl-k">.</span>createCopy(excludeEmployees, <span class="pl-stj">PropertyTreeUse</span><span class="pl-c1"><span class="pl-k">.</span>INCLUDE</span>);</pre></div>

<p>or</p>

<div class="highlight highlight-java"><pre>    <span class="pl-s">final</span> <span class="pl-stj">BusinessPartner</span> businessPartnerCopy <span class="pl-k">=</span> businessPartner<span class="pl-k">.</span>copyOnly(excludeEmployees);</pre></div>

<p>which will result in a businessPartnerCopy where every property is set to null, except the company property,
and in the attached company object, every property is null except "employees".</p>

<p>This works for single and multi-valued properties, where for multi-valued properties, the property tree applies to
all elements of the list of values in the same way. As of yet, there is no way to make a tree apply only to specific indexes
in generated lists.</p>

<h3>
<a id="usage-3" class="anchor" href="#usage-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>Plugin activation: <code>-Xcopy</code>.
Options:</p>

<h4>
<a id="-constructoryn" class="anchor" href="#-constructoryn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-constructor=</code>y/n</h4>

<p>Generates a copy constructor.</p>

<h4>
<a id="-narrowyn" class="anchor" href="#-narrowyn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-narrow=</code>y/n</h4>

<p>If copy constructors are created, they are generated in such a way that, in order to copy descendant objects,
they call the copy constructors of any descendant property types found in the tree. This will result in an object
tree that contains only the "narrowest" possible representation. For properties declared with an
abstract type, their <code>clone()</code>-Methods will be called instead, resulting in an exact runtime copy. Default: no.</p>

<h4>
<a id="-partialyn" class="anchor" href="#-partialyn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-partial=</code>y/n</h4>

<p>Create partial clone method and - if constructor generation is selected, a partial copy constructor. (see above)</p>

<h4>
<a id="-generatetoolsyn" class="anchor" href="#-generatetoolsyn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-generateTools=</code>y/n</h4>

<p>Generate prerequisite classes like e.g. <code>com.kscs.util.jaxb.Copyable</code> and <code>com.kscs.util.jaxb.PropertyPath</code> as source files into the generated source
packages. If you say 'no' here, you will have to add the jaxb2-rich-contract-plugin jar to your
compile- and runtime classpath.</p>

<h3>
<a id="limitations-1" class="anchor" href="#limitations-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>Limitations</h3>

<ul>
<li>The <code>-narrow</code> option is a somewhat special use case and should be used carefully.</li>
</ul>

<h2>
<a id="clone" class="anchor" href="#clone" aria-hidden="true"><span class="octicon octicon-link"></span></a>clone</h2>

<h3>
<a id="motivation-3" class="anchor" href="#motivation-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation</h3>

<p>Another way to create a deep copy of an object tree. This adheres to the <code>java.lang.Cloneable</code> contract, but isn't
as versatile as <code>-Xcopy</code>.</p>

<h3>
<a id="function-3" class="anchor" href="#function-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Function</h3>

<p>The <code>clone</code> plugin generates a deep clone method for each of the generated classes, based on the following assumptions:</p>

<ul>
<li><p>Instances of any other class generated from the same XSD model are cloneable by the same semantics as "this".</p></li>
<li><p>Objects implementing <code>java.lang.Cloneable</code> and not throwing "CloneNotSupportedException" are also reliably cloneable
by their "clone" Method.</p></li>
<li><p>Objects not implementing <code>java.lang.Cloneable</code> or primitive types are assumed to be immutable,
their references are copied over, they are not cloned.</p></li>
</ul>

<h3>
<a id="usage-4" class="anchor" href="#usage-4" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>Plugin activation: <code>-Xclone</code>.
Options:</p>

<h4>
<a id="-clonethrowsyn" class="anchor" href="#-clonethrowsyn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-cloneThrows=</code>y/n</h4>

<p>Declare "clone()"-Method to throw "CloneNotSupportedException" any of the cloneable child
objects have a "clone" method that declares <code>CloneNotSupportedException</code> being thrown.
The JDK spec says objects should declare their "clone" method with "throws CloneNotSuppoertedException"
in order to enable subclasses to inhibit cloning even if their superclass declares "Cloneable".
In pratice, however, this doesn't make much sense and is against object-oriented principles.
All classes implementing <code>Cloneable</code> should really be cloneable and NOT throw
a <code>CloneNotSupportedException</code>.
Ordinary Exceptions during cloning are rethrown as <code>RuntimeExceptions</code>,
if this is set to "no", this is also true for any exceptions thrown by descendant objects,
no matter whether they are <code>CloneNotSupported</code>or anything else. If this is "yes", any possible
<code>CloneNotSupportedException</code> will be declared in the throws clause. This option will not
affect generated "partial" clone methods. Default: no.</p>

<h2>
<a id="immutable" class="anchor" href="#immutable" aria-hidden="true"><span class="octicon octicon-link"></span></a>immutable</h2>

<h3>
<a id="motivation-4" class="anchor" href="#motivation-4" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation</h3>

<p>Contemporary programming styles include making objects immutable as much as possible, to minimise
side effects and allow for functional programming patterns.</p>

<h3>
<a id="function-4" class="anchor" href="#function-4" aria-hidden="true"><span class="octicon octicon-link"></span></a>Function</h3>

<p>This plugin simply makes all "setXXX" methods "protected", thus preventing API consumers to modify
state of instances of generated classes after they have been created. This only makes sense together with
another plugin that allows for initialization of the instances, like e.g. the included <code>fluent-builder</code> plugin.
For collection-valued properties, <code>-Ximmutable</code> wraps all collections in a <code>Collections.unmodifiableCollection</code>,
so collections are also made immutable.
Because JAXB serialization has a number of constraints regarding the internals of JAXB serializable objects,
it wasn't advisable to just remove the setter methods or replace the collections with unmodifiable collections.
So, a bit of additional code will be created that leaves the old "mutable" structure of the class intact as much
as is needed for JAXB, but modifies the public interface so objects appear immutable to client code.</p>

<h3>
<a id="usage-5" class="anchor" href="#usage-5" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>Plugin activation: <code>-Ximmutable</code></p>

<h3>
<a id="limitations-2" class="anchor" href="#limitations-2" aria-hidden="true"><span class="octicon octicon-link"></span></a>Limitations</h3>

<ul>
<li>Access level "protected" may not be strict enough to prevent state changes.</li>
<li>If you activate plugins like "fluent-api" or the like, these plugins may circumvent the protection provided by the <code>immutable</code> plugin.</li>
</ul>

<h2>
<a id="fluent-builder" class="anchor" href="#fluent-builder" aria-hidden="true"><span class="octicon octicon-link"></span></a>fluent-builder</h2>

<h3>
<a id="motivation-5" class="anchor" href="#motivation-5" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation</h3>

<p>There already is the widely used "fluent-api" plugin for XJC.
That, however isn't a real builder pattern since there is no strict programmatic distinction between initialization
and state change in fluent-api.</p>

<p>fluent-builder now creates a real "Builder" pattern, implemented as an inner class to the generated classes.</p>

<h3>
<a id="function-5" class="anchor" href="#function-5" aria-hidden="true"><span class="octicon octicon-link"></span></a>Function</h3>

<p>fluent-builder creates a static inner class for every generated class representing the builder, and a static
method on the generated class to create a builder.</p>

<p>If the "immutable" plugin is also activated, publicly exposed collections will be immutable, too.</p>

<p>Example use in code:</p>

<div class="highlight highlight-java"><pre>    <span class="pl-stj">MyElement</span> newElement <span class="pl-k">=</span> <span class="pl-stj">MyElement</span><span class="pl-k">.</span>builder()<span class="pl-k">.</span>withPropertyA(<span class="pl-c1">...</span>)<span class="pl-k">.</span>withPropertyB(<span class="pl-c1">...</span>)<span class="pl-k">.</span>addCollectionPropertyA(<span class="pl-c1">...</span>)<span class="pl-k">.</span>build();</pre></div>

<p>In addition, new instances can be created as copies of existing instances using the builder, with an optional modification by othe builder methods:</p>

<div class="highlight highlight-java"><pre>    <span class="pl-stj">MyElement</span> newElement <span class="pl-k">=</span> <span class="pl-stj">MyElement</span><span class="pl-k">.</span>copyOf(oldElement)<span class="pl-k">.</span>withPropertyA(<span class="pl-c1">...</span>)<span class="pl-k">.</span>withPropertyB(<span class="pl-c1">...</span>)<span class="pl-k">.</span>build();</pre></div>

<p>The "partial" copy introduced in the "clone" plugin will work here as well:</p>

<div class="highlight highlight-java"><pre>    <span class="pl-stj">PropertyTree</span> selection <span class="pl-k">=</span> <span class="pl-stj">MyElement</span><span class="pl-k">.</span><span class="pl-stj">Select</span><span class="pl-k">.</span>root()<span class="pl-k">.</span>propertyA()<span class="pl-k">.</span>propertyAB()<span class="pl-k">.</span>build();
    <span class="pl-stj">MyElement</span> newElement <span class="pl-k">=</span> <span class="pl-stj">MyElement</span><span class="pl-k">.</span>copyExcept(oldElement, selection)<span class="pl-k">.</span>withPropertyA(<span class="pl-c1">...</span>)<span class="pl-k">.</span>withPropertyB(<span class="pl-c1">...</span>)<span class="pl-k">.</span>build();</pre></div>

<p>Often, properties of generated classes represent containment or references to generated classes in the same model.
The fluent-builder plugin lets you initialise properties of such a type - if it isn't an abstract type - by using sub-builders ("chained" builders) in the following way, given that both A and B are types defined in the XSD model, and A has a property of type B, and B has three properties of type String, x,y, and z:</p>

<div class="highlight highlight-java"><pre>    <span class="pl-stj">A</span> newA <span class="pl-k">=</span> <span class="pl-stj">A</span><span class="pl-k">.</span>builder()<span class="pl-k">.</span>withB()<span class="pl-k">.</span>withX(<span class="pl-s1"><span class="pl-pds">"</span>x<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>withY(<span class="pl-s1"><span class="pl-pds">"</span>y<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>withZ(<span class="pl-s1"><span class="pl-pds">"</span>z<span class="pl-pds">"</span></span>)<span class="pl-k">.</span>end()<span class="pl-k">.</span>build();</pre></div>

<p>Of course, this plugin is most useful if <code>immutable</code> is also activated.</p>

<h3>
<a id="usage-6" class="anchor" href="#usage-6" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>Plugin activation: <code>-Xfluent-builder</code></p>

<p>Options:</p>

<h4>
<a id="-narrowyn-1" class="anchor" href="#-narrowyn-1" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-narrow=</code>y/n</h4>

<p>When creating a builder via <code>copyOf()</code>, the narrowest possible copy of the input object is instantiated.
See also the documentation on <code>-Xclone</code> for a discussion.</p>

<h4>
<a id="-copypartialyn" class="anchor" href="#-copypartialyn" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-copyPartial=</code>y/n</h4>

<p>If set to true, generates a <code>copyOf()</code>-Method that takes an additional <code>PropertyPath</code> parameter to limit
the copying to a certain depth or certain nodes in the object tree.</p>

<h3>
<a id="limitations-3" class="anchor" href="#limitations-3" aria-hidden="true"><span class="octicon octicon-link"></span></a>Limitations</h3>

<ul>
<li><p>It generates a large amount of code.</p></li>
<li><p>Note: Shared builder instances are NOT thread-safe by themselves.</p></li>
</ul>

<h2>
<a id="meta" class="anchor" href="#meta" aria-hidden="true"><span class="octicon octicon-link"></span></a>meta</h2>

<h3>
<a id="motivation-6" class="anchor" href="#motivation-6" aria-hidden="true"><span class="octicon octicon-link"></span></a>Motivation</h3>

<p>Sometimes, you need information about the properties of a class, or you wish to have a constant for the
names of properties.
The "meta" plugin creates an inner class (the name of which can be controlled by a command-line option),
and adds a constant field for each property.
If the <code>-extended=y</code> commandÂ´ine option is specified, these constants will hold instances of the <code>PropertyInfo</code>
class, on which the name, type, multiplicity (collection or not) and default value (from XSD) are exposed.
Without <code>-extended</code>, the constants are simply string constants holding the property names.</p>

<h3>
<a id="usage-7" class="anchor" href="#usage-7" aria-hidden="true"><span class="octicon octicon-link"></span></a>Usage</h3>

<p>Plugin activation: <code>-Xmeta</code></p>

<p>Options:</p>

<h4>
<a id="-extendedyn-n" class="anchor" href="#-extendedyn-n" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-extended=</code>y/n (n)</h4>

<p>If "y", extended property information (see above) will be generated, if "n", only string constants are generated for each property.
Default: n</p>

<h4>
<a id="-camel-caseyn-n" class="anchor" href="#-camel-caseyn-n" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-camel-case=</code>y/n (n)</h4>

<p>If "y", generates the constant fields with exactly the same name as the properties they are describing.
If "n" (the default), they will be generated according to the java naming convention for constants.</p>

<h4>
<a id="-meta-class-name-propinfo" class="anchor" href="#-meta-class-name-propinfo" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-meta-class-name=</code> ("PropInfo")</h4>

<p>Specifies the name of the generated nested meta info class. By default, this is "PropInfo", but
because naming conflicts are likely, you can choose a different name here.</p>

<h4>
<a id="-generate-toolsyn-y" class="anchor" href="#-generate-toolsyn-y" aria-hidden="true"><span class="octicon octicon-link"></span></a>
<code>-generate-tools=</code>y/n (y)</h4>

<p>As with some of the other plugins, the code generated with the <code>-extended</code> option set requires an
additional helper class at compile time. If you say "y" here (the default), this helper class is
generated as part of the generated code, if also the <code>-extended</code> option is set to "y".
If you use <code>-extended</code> but say "no" here, you will have to add the plugin artifact to the compile (and run)-time
classpath of your generated code.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Jaxb2-rich-contract-plugin maintained by <a href="https://github.com/mklemm">mklemm</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
